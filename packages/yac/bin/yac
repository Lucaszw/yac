#!/usr/bin/env node
const {spawnSync} = require('child_process');
const hasbin = require('hasbin');
const yacInit = require('@yac/init');
const yacInstall = require('@yac/install');

const CWD = (argv) => {
  if (argv.cwd == undefined) { argv.cwd = process.cwd(); }
  return argv.cwd;
}

const argv = require('yargs')
  .option('cwd', {
    describe: 'change directory of execution',
    type: 'string'
  })
  .command('conda-info', 'show active conda', () => {}, (argv) => {
    if (hasbin.sync('conda')) {
      spawnSync('conda info', [], {stdio: 'inherit', shell: true});
    }
  })
  .command('init', 'initialize a yac project', () => {}, (argv) => {
    yacInit(CWD(argv));
  })
  .command('install', 'install dependencies', () => {}, (argv) => {
    yacInstall(CWD(argv));
  })
.argv;
